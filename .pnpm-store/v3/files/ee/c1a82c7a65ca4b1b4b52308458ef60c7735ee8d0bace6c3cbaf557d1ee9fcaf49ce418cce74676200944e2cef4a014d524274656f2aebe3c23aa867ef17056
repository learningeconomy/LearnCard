"use strict";var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.getSlotToken=getSlotToken;exports.isSlotOf=isSlotOf;exports.createSlots=createSlots;exports.forwardWithSlots=exports.SLOT_KEY=void 0;var _defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));var _toConsumableArray2=_interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _typeof2=_interopRequireDefault(require("@babel/runtime/helpers/typeof"));var React=_interopRequireWildcard(require("react"));var _fromEntries=require("./fromEntries");var _isReactInstanceOf=require("./isReactInstanceOf");var _createInstanceIfDefined=require("./createInstanceIfDefined");var _arrayify=require("./arrayify");function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable});keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){(0,_defineProperty2["default"])(target,key,source[key])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source))}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}}return target}var SLOT_KEY="_SLOT_";exports.SLOT_KEY=SLOT_KEY;function getSlotToken(child){if(!child){return}return child.type?child.type[SLOT_KEY]:child[SLOT_KEY]}function isSlotOf(child,identifier){var token=(0,_typeof2["default"])(identifier)==="symbol"?identifier:getSlotToken(identifier);return token?getSlotToken(child)===token:(0,_isReactInstanceOf.isReactInstanceOf)(child,identifier)}var forwardWithSlots=function forwardWithSlots(Component){var forwarded=React.forwardRef(Component);return forwarded};exports.forwardWithSlots=forwardWithSlots;function createSlots(props,componentMapping){var omit=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[];var otherChildren=[];var slotNames=Object.keys(componentMapping);var components=(0,_fromEntries.fromEntries)(slotNames.map(function(slot){return[slot,(0,_arrayify.arrayify)(componentMapping[slot])]}));var slots=(0,_fromEntries.fromEntries)(slotNames.map(function(prop){var SlotComp=components[prop][0];var slotProps=props[prop];if((0,_typeof2["default"])(SlotComp)==="symbol"&&slotProps){throw new Error("Cannot create instance for ".concat(prop," when using slot tokens. Use children instead."))}return[prop,(0,_createInstanceIfDefined.createInstanceIfDefined)(slotProps,SlotComp)]}));var passThroughProps=(0,_fromEntries.fromEntries)(Object.entries(props).filter(function(_ref){var _ref2=(0,_slicedToArray2["default"])(_ref,1),key=_ref2[0];return componentMapping[key]===undefined&&!omit.includes(key)}));React.Children.forEach(props.children,function(child){var slotName=slotNames.find(function(propName){return components[propName].find(function(comp){return isSlotOf(child,comp)})});if(!slotName){return otherChildren.push(child)}var slot=slots[slotName];slots[slotName]=slot?[].concat((0,_toConsumableArray2["default"])((0,_arrayify.arrayify)(slot)),(0,_toConsumableArray2["default"])((0,_arrayify.arrayify)(child))):child});return _objectSpread(_objectSpread(_objectSpread({},passThroughProps),slots),{},{children:otherChildren.length?otherChildren:undefined})}
//# sourceMappingURL=createSlots.js.map