(function(){let u=null,l=null,h=!1,y=!1;const p=(e,o=200)=>{let t;return()=>{t&&window.clearTimeout(t),t=window.setTimeout(e,o)}},m=()=>{if(y)return;const e=history.pushState;history.pushState=function(...t){const r=e.apply(this,t);return window.dispatchEvent(new Event("locationchange")),r};const o=history.replaceState;history.replaceState=function(...t){const r=o.apply(this,t);return window.dispatchEvent(new Event("locationchange")),r},window.addEventListener("popstate",()=>{window.dispatchEvent(new Event("locationchange"))}),y=!0},w=()=>{const e=Array.from(document.querySelectorAll('a[href^="dccrequest://"], a[href^="msprequest://"]')),o=new Set,t=/credly\.com/.test(location.hostname)?"credly":/coursera\.org/.test(location.hostname)?"coursera":"unknown",r=[];for(const i of e){const n=i.href;!n||o.has(n)||(o.add(n),r.push({source:"link",url:n,title:i.textContent?.trim()||document.title,platform:t}))}return r},S=e=>{if(!e||typeof e!="object")return!1;const o=e,t=o["@context"],r=o.type;return Array.isArray(t)&&(Array.isArray(r)||typeof r=="string")},v=()=>{const e=/credly\.com/.test(location.hostname)?"credly":/coursera\.org/.test(location.hostname)?"coursera":"unknown",o=[],t=n=>{if(Array.isArray(n)){for(const s of n)t(s);return}S(n)&&o.push({source:"jsonld",raw:n,title:n.name||document.title,platform:e})},r=Array.from(document.querySelectorAll('script[type="application/ld+json"]'));for(const n of r)try{const s=JSON.parse(n.textContent||"null");if(!s)continue;t(s)}catch{}const i=Array.from(document.querySelectorAll("pre, code"));for(const n of i){const s=n.textContent;if(s&&s.includes('"VerifiableCredential"')&&s.includes('"credentialSubject"'))try{const c=JSON.parse(s);t(c)}catch{}}return o},a=()=>{const e=w(),o=v(),t=new Map,r=/credly\.com/.test(location.hostname)?"credly":/coursera\.org/.test(location.hostname)?"coursera":"unknown",i=c=>{if(c.url)return`url:${c.url}`;try{return`raw:${JSON.stringify(c.raw)}`}catch{return`raw:${String(c.title??"")}:${r}`}};for(const c of[...e,...o]){const f=i(c);t.has(f)||t.set(f,c)}const n=Array.from(t.values()),s=`${n.length}:${Array.from(t.keys()).sort().join("|")}`;s!==u&&(u=s,chrome.runtime.sendMessage({type:"credentials-detected",payload:n}))},d=()=>{if(!l){const e=p(a,200);l=new MutationObserver(()=>{e()}),l.observe(document.documentElement,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["href"]})}if(!h){m();const e=()=>{u=null,l||d(),a()};window.addEventListener("hashchange",e),window.addEventListener("locationchange",e),document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&a()}),h=!0}};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{a(),d()}):(a(),d());
//# sourceMappingURL=main.ts-Cq63oivV.js.map
})()
